deter mean tensor(-0.0002, device='cuda:0')
deter mean tensor(-0.0002, device='cuda:0')
deter mean tensor(-0.0002, device='cuda:0')
deter mean tensor(-0.0002, device='cuda:0')
deter mean tensor(-0.0002, device='cuda:0')
deter mean tensor(-0.0001, device='cuda:0')
deter mean tensor(-0.0002, device='cuda:0')
deter mean tensor(-0.0002, device='cuda:0')
deter mean tensor(-0.0002, device='cuda:0')
deter mean tensor(-0.0002, device='cuda:0')
deter mean tensor(-0.0001, device='cuda:0')
deter mean tensor(-0.0001, device='cuda:0')
deter mean tensor(-0.0001, device='cuda:0')
deter mean tensor(-0.0001, device='cuda:0')
deter mean tensor(-0.0001, device='cuda:0')
deter mean tensor(-0.0001, device='cuda:0')
deter mean tensor(-0.0001, device='cuda:0')
deter mean tensor(-0.0001, device='cuda:0')
deter mean tensor(-0.0001, device='cuda:0')
deter mean tensor(-0.0001, device='cuda:0')
Error in sys.excepthook:
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/dist-packages/wandb/sdk/lib/exit_hooks.py", line 42, in exc_handler
    def exc_handler(
KeyboardInterrupt
Original exception was:
Traceback (most recent call last):
  File "/content/gdrive/.shortcut-targets-by-id/11LtEVzXkuxeMRaphtv1mvl4gTyvST0vX/pgmproj/train.py", line 96, in <module>
    train_dreamer(exp, n_workers=args.n_workers)
  File "/content/gdrive/.shortcut-targets-by-id/11LtEVzXkuxeMRaphtv1mvl4gTyvST0vX/pgmproj/train.py", line 23, in train_dreamer
    runner.run(exp.steps, exp.episodes)
  File "/content/gdrive/.shortcut-targets-by-id/11LtEVzXkuxeMRaphtv1mvl4gTyvST0vX/pgmproj/agent/runners/DreamerRunner.py", line 51, in run
    self.learner.step(rollout)
  File "/content/gdrive/.shortcut-targets-by-id/11LtEVzXkuxeMRaphtv1mvl4gTyvST0vX/pgmproj/agent/learners/DreamerLearner.py", line 129, in step
    self.train_action_model(samples2)
  File "/content/gdrive/.shortcut-targets-by-id/11LtEVzXkuxeMRaphtv1mvl4gTyvST0vX/pgmproj/agent/learners/DreamerLearner.py", line 148, in train_action_model
    loss = action_model_loss(self.config, self.action_model, samples['observation'], samples['action'], samples['av_action'],
  File "/content/gdrive/.shortcut-targets-by-id/11LtEVzXkuxeMRaphtv1mvl4gTyvST0vX/pgmproj/agent/optim/action_loss.py", line 36, in action_model_loss
    prior, post, deters = rollout_representation(config, model.representation, time_steps, action_embed, obs, prev_state, last) #TODO
  File "/content/gdrive/.shortcut-targets-by-id/11LtEVzXkuxeMRaphtv1mvl4gTyvST0vX/pgmproj/networks/dreamer/action_model_rnns.py", line 177, in rollout_representation
    prior_states, posterior_states = representation_model(action_embed[t], obs[t], prev_states)
  File "/usr/local/lib/python3.9/dist-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/content/gdrive/.shortcut-targets-by-id/11LtEVzXkuxeMRaphtv1mvl4gTyvST0vX/pgmproj/networks/dreamer/action_model_rnns.py", line 153, in forward
    prior_states = self._transition_model(obs, prev_states, mask)
  File "/usr/local/lib/python3.9/dist-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/content/gdrive/.shortcut-targets-by-id/11LtEVzXkuxeMRaphtv1mvl4gTyvST0vX/pgmproj/networks/dreamer/action_model_rnns.py", line 104, in forward
    attn = self._attention_stack(stoch_input, mask=mask)
  File "/usr/local/lib/python3.9/dist-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/content/gdrive/.shortcut-targets-by-id/11LtEVzXkuxeMRaphtv1mvl4gTyvST0vX/pgmproj/networks/transformer/layers.py", line 42, in forward
    x = self.encoder(enc_input.permute(1, 0, 2), **kwargs)
  File "/usr/local/lib/python3.9/dist-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.9/dist-packages/torch/nn/modules/transformer.py", line 306, in forward
    output = mod(output, src_mask=mask, is_causal=is_causal, src_key_padding_mask=src_key_padding_mask_for_layers)
  File "/usr/local/lib/python3.9/dist-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.9/dist-packages/torch/nn/modules/transformer.py", line 574, in forward
    x = self.norm2(x + self._ff_block(x))
  File "/usr/local/lib/python3.9/dist-packages/torch/nn/modules/transformer.py", line 589, in _ff_block
    x = self.linear2(self.dropout(self.activation(self.linear1(x))))
  File "/usr/local/lib/python3.9/dist-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.9/dist-packages/torch/nn/modules/linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
KeyboardInterrupt